var e,t,o;e=new(function(){var e;function t(){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.startButton=document.querySelector(".button"),this.scoreboard=document.querySelector(".game-score"),this.board=[],this.cellHistory=[],this.status="idle"}return e=[{key:"move",value:function(e){if("playing"===this.getStatus()){this.cellHistory=[];var t=JSON.stringify(this.board);switch(e){case"left":this.moveLeft(this.board);break;case"right":this.moveRight(this.board);break;case"up":this.moveUp(this.board);break;case"down":this.moveDown(this.board)}if(JSON.stringify(this.board)!==t)this.addRandomCell(),this.displayGame();else{var o=JSON.parse(JSON.stringify(this.board)),s=this.getEmptyCell();this.moveLeft(o),this.moveRight(o),this.moveUp(o),this.moveDown(o),s.length||JSON.stringify(o)!==t||this.setStatus("lose")}}}},{key:"moveLeft",value:function(e){for(var t=0;t<e.length;t++)for(var o=0,s=0;s<e.length;s++)if(0!==e[t][s]){var r=e[t][s];if(o!==s&&(this.cellHistory.push({value:r,oldCoords:{X:s,Y:t},newCoords:{X:o,Y:t},move:!0}),e[t][o]=r,e[t][s]=0),o>0&&e[t][o]===e[t][o-1]){var a=2*e[t][o],n=this.cellHistory[this.cellHistory.length-1];n&&n.newCoords.Y===t&&n.newCoords.X===o?(n.merge=!0,n.newCoords.X=o-1,n.problem=!0):this.cellHistory.push({value:a,oldCoords:{Y:t,X:o},newCoords:{Y:t,X:o-1},merge:!0}),e[t][o-1]=a,e[t][o]=0,o--}o++}return e}},{key:"moveRight",value:function(e){for(var t=0;t<e.length;t++)for(var o=e.length-1,s=e.length-1;s>=0;s--)if(0!==e[t][s]){var r=e[t][s];if(o!==s&&(this.cellHistory.push({value:r,oldCoords:{Y:t,X:s},newCoords:{Y:t,X:o},move:!0}),e[t][o]=r,e[t][s]=0),o<e.length-1&&e[t][o]===e[t][o+1]){var a=2*e[t][o],n=this.cellHistory[this.cellHistory.length-1];n&&n.newCoords.Y===t&&n.newCoords.X===o?(n.merge=!0,n.newCoords.X=o+1):this.cellHistory.push({value:a,oldCoords:{Y:t,X:o},newCoords:{Y:t,X:o+1},merge:!0}),e[t][o+1]=a,e[t][o]=0,o++}o--}return e}},{key:"moveUp",value:function(e){for(var t=0;t<e.length;t++)for(var o=0,s=0;s<e.length;s++)if(0!==e[s][t]){var r=e[s][t];if(o!==s&&(this.cellHistory.push({value:r,oldCoords:{Y:s,X:t},newCoords:{Y:o,X:t},move:!0}),e[o][t]=r,e[s][t]=0),o>0&&e[o][t]===e[o-1][t]){var a=2*e[o][t],n=this.cellHistory[this.cellHistory.length-1];n&&n.newCoords.Y===o&&n.newCoords.X===t?(n.merge=!0,n.newCoords.Y=o-1):this.cellHistory.push({value:a,oldCoords:{Y:o,X:t},newCoords:{Y:o-1,X:t},merge:!0}),e[o-1][t]=a,e[o][t]=0,o--}o++}return e}},{key:"moveDown",value:function(e){for(var t=0;t<e.length;t++)for(var o=e.length-1,s=e.length-1;s>=0;s--)if(0!==e[s][t]){var r=e[s][t];if(o!==s&&(this.cellHistory.push({value:r,oldCoords:{Y:s,X:t},newCoords:{Y:o,X:t},move:!0}),e[o][t]=r,e[s][t]=0),o<e.length-1&&e[o][t]===e[o+1][t]){var a=2*e[o][t],n=this.cellHistory[this.cellHistory.length-1];n&&n.newCoords.Y===o&&n.newCoords.X===t?(n.merge=!0,n.newCoords.Y=o+1):this.cellHistory.push({value:r,oldCoords:{Y:s,X:t},newCoords:{Y:o+1,X:t},merge:!0}),e[o+1][t]=a,e[o][t]=0,o++}o--}return e}},{key:"getScore",value:function(){var e=0,t=!0,o=!1,s=void 0;try{for(var r,a=this.board[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var n=r.value;e+=n.reduce(function(e,t){return e+t},0)}}catch(e){o=!0,s=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw s}}return e}},{key:"setStatus",value:function(e){switch(e){case"playing":this.status="playing",this.setMessage();break;case"idle":this.status="idle",this.setMessage("start");break;case"win":this.status="win",this.setMessage("win");break;case"lose":this.status="lose",this.setMessage("lose")}}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.startButton.textContent="Restart",this.startButton.className="button restart",this.setStatus("playing"),this.board=JSON.parse(JSON.stringify(this.initialState)),this.addRandomCell(),this.addRandomCell(),this.displayGame()}},{key:"setMessage",value:function(e){var t=document.querySelector(".message-win"),o=document.querySelector(".message-lose"),s=document.querySelector(".message-start");switch(o.className="message message-lose hidden",s.className="message message-start hidden",t.className="message message-win hidden",e){case"win":t.className="message message-win";break;case"lose":o.className="message message-lose";break;case"start":s.className="message message-start"}}},{key:"restart",value:function(){this.clearBoard(),this.cellHistory=[],this.setStatus("idle"),this.startButton.textContent="Start",this.startButton.className="button start",this.scoreboard.textContent=0}},{key:"getEmptyCell",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var o=0;o<this.board.length;o++)this.board[t][o]||e.push({x:o,y:t});return e}},{key:"addRandomCell",value:function(){var e=this.getEmptyCell();if(e.length>0){var t=Math.floor(Math.random()*e.length),o=e[t];this.board[o.y][o.x]=.9>Math.random()?2:4,this.cellHistory.push({value:this.board[o.y][o.x],newCoords:{X:o.x,Y:o.y},newCell:!0})}}},{key:"displayGame",value:function(){this.displayAnimateBoard(),this.scoreboard.textContent=this.getScore()}},{key:"displayAnimateBoard",value:function(){var e=!0,t=!1,o=void 0;try{for(var s,r=this.cellHistory[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var a=s.value,n=document.querySelector(".move-zone");if(a.newCell){var i=document.createElement("div");n.appendChild(i),i.textContent=a.value,i.className="moving-block field-cell--".concat(a.value),i.id="cell".concat(a.newCoords.Y).concat(a.newCoords.X),i.style.setProperty("--y",a.newCoords.Y),i.style.setProperty("--x",a.newCoords.X);var l=[{transform:"scale(1)"},{transform:"scale(1.56)"},{transform:"scale(1)"}],c={duration:400,iterations:1,easing:"ease-in-out"};i.animate(l,c)}else if("playing"===this.getStatus()){var d=document.getElementById("cell".concat(a.oldCoords.Y).concat(a.oldCoords.X)),h="cell".concat(a.newCoords.Y).concat(a.newCoords.X);document.querySelector("#"+h)&&document.querySelector("#"+h).remove(),d.id=h,d.className="moving-block field-cell--".concat(this.board[a.newCoords.Y][a.newCoords.X]),d.textContent=this.board[a.newCoords.Y][a.newCoords.X],d.style.setProperty("--y",a.newCoords.Y),d.style.setProperty("--x",a.newCoords.X)}}}catch(e){t=!0,o=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw o}}}},{key:"nonAnimateUpdateBoard",value:function(){this.clearBoard();for(var e=0;e<this.board.length;e++)for(var t=0;t<this.board.length;t++)if(0!==this.board[e][t]){var o=document.querySelector("#cell".concat(e).concat(t));o.textContent=this.board[e][t],o.className="field-cell field-cell--".concat(this.board[e][t])}}},{key:"clearBoard",value:function(){document.querySelectorAll(".moving-block").forEach(function(e){e.remove()})}}],function(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(t.prototype,e),t}()),t=document.querySelector(".button"),o=document.querySelector("h1"),t.onclick=function(){"Start"===t.textContent?e.start():e.restart()},o.onclick=function(){e.animation()},addEventListener("keydown",function(t){switch(t.key){case"ArrowUp":e.move("up");break;case"ArrowDown":e.move("down");break;case"ArrowRight":e.move("right");break;case"ArrowLeft":e.move("left")}});
//# sourceMappingURL=index.2eb4e2d8.js.map
